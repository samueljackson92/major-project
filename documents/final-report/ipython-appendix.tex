\chapter{IPython Notebooks}

\section*{Blob Analysis}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{inline}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Warning: Cannot change to a different GUI toolkit: qt. Using osx instead.
    \end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{hologic\PYZus{}blobs.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{synthetic\PYZus{}blobs.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                                \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
         \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

         \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
         \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
         \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{hologic\PYZus{}blob\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{features\PYZus{}from\PYZus{}blobs}\PY{p}{(}\PY{n}{hologic}\PY{p}{)}
         \PY{n}{phantom\PYZus{}blob\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{features\PYZus{}from\PYZus{}blobs}\PY{p}{(}\PY{n}{phantom}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
         \PY{n}{phantom\PYZus{}blob\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
         \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}blob\PYZus{}features}\PY{p}{,}
                                                                          \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
         \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
         \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}88}]:}                        blob\_count  avg\_radius  std\_radius  min\_radius  \textbackslash{}
         p214-010-60001-cl.png          56   22.121831   22.923389           8
         p214-010-60001-cr.png          78   19.054538   17.506086           8
         p214-010-60001-ml.png          98   20.011191   21.876304           8
         p214-010-60001-mr.png         139   15.309764   15.307860           8
         p214-010-60005-cl.png          97   20.132590   23.255605           8

                                max\_radius  small\_radius\_count  med\_radius\_count  \textbackslash{}
         p214-010-60001-cl.png  128.000000                  52                 1
         p214-010-60001-cr.png   90.509668                  68                 4
         p214-010-60001-ml.png  128.000000                  90                 3
         p214-010-60001-mr.png  128.000000                 136                 1
         p214-010-60005-cl.png  181.019336                  94                 2

                                large\_radius\_count    density  upper\_dist\_count  25\%  \textbackslash{}
         p214-010-60001-cl.png                   3  52.940812                21    8
         p214-010-60001-cr.png                   6  40.749811                22    8
         p214-010-60001-ml.png                   5  42.644057                27    8
         p214-010-60001-mr.png                   2  38.287439                40    8
         p214-010-60005-cl.png                   1  41.456308                27    8

                                      50\%        75\%
         p214-010-60001-cl.png  11.313708  22.627417
         p214-010-60001-cr.png  11.313708  22.627417
         p214-010-60001-ml.png  11.313708  22.627417
         p214-010-60001-mr.png  11.313708  16.000000
         p214-010-60005-cl.png  11.313708  22.627417
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{min\PYZus{}radius}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                         \PY{n}{phantom\PYZus{}blob\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

         \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/blob\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:}                           KS       p-value
         blob\_count          0.341667  2.774753e-07
         avg\_radius          0.847222  1.360953e-42
         std\_radius          0.711111  3.929143e-30
         max\_radius          0.363889  3.327680e-08
         small\_radius\_count  0.319444  2.024353e-06
         med\_radius\_count    0.338889  3.583275e-07
         large\_radius\_count  0.733333  5.112303e-32
         density             0.169444  4.114705e-02
         upper\_dist\_count    0.345833  1.883393e-07
         25\%                 0.358333  5.726005e-08
         50\%                 0.743056  7.334764e-33
         75\%                 0.777778  5.796838e-36
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.989818
[t-SNE] Error after 83 iterations with early exaggeration: 12.840095
[t-SNE] Error after 284 iterations: 0.384253
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/blob\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.989818
[t-SNE] Error after 83 iterations with early exaggeration: 13.395568
[t-SNE] Error after 228 iterations: 0.412479
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}126}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x11472cdd0>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
5.68455464542
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{n}{mia}\PY{o}{.}\PY{n}{io\PYZus{}tools}\PY{o}{.}\PY{n}{dump\PYZus{}mapping\PYZus{}to\PYZus{}json}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{]}\PY{p}{,}
                                            \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{data.json}\PY{l+s}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/blob\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
4.26343423263
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,} 
					\PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}123}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x11230ecd0>
\end{Verbatim}

    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
          \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1.17807316961e-07
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/blob\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}blob\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}blob\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}124}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x1124fee10>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{50}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
          \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
          \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

          \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
          \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
          \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                             \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                             \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                             \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                        \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                        \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                  \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                  \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                             \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                             \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                             \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                        \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                        \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                  \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                  \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/blob\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{blob-analysis_files/blob-analysis_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
\section*{Blob Intensity Analysis}



    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{qt}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Warning: Cannot change to a different GUI toolkit: qt. Using osx instead.
    \end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{real\PYZus{}intensity.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{hologic}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}

         \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{synthetic\PYZus{}intensity.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{phantom}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                                 \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
         \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

         \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
         \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
         \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{hologic\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{hologic}\PY{p}{)}
         \PY{n}{phantom\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{phantom}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
         \PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
         \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset} \PYZbs{}
             \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
         \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
         \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:}                        count      mean       std       min       25\%  \textbackslash{}
         p214-010-60001-cl.png    256  0.610387  0.076183  0.411502  0.555738
         p214-010-60001-cr.png    256  0.558904  0.087279  0.328763  0.510450
         p214-010-60001-ml.png    256  0.566832  0.079640  0.349452  0.515433
         p214-010-60001-mr.png    256  0.534146  0.093002  0.287792  0.476245
         p214-010-60005-cl.png    256  0.613984  0.074093  0.396148  0.565591

                                     50\%       75\%       max      skew  kurtosis  \textbackslash{}
         p214-010-60001-cl.png  0.613839  0.667148  0.781775 -0.176690 -0.383312
         p214-010-60001-cr.png  0.570363  0.622144  0.724731 -0.406150 -0.127657
         p214-010-60001-ml.png  0.572314  0.625658  0.741338 -0.329743 -0.087993
         p214-010-60001-mr.png  0.543159  0.600705  0.728595 -0.344968  0.028718
         p214-010-60005-cl.png  0.620705  0.668532  0.766788 -0.386427 -0.065749

                                   \ldots      count\_9    mean\_9     std\_9     min\_9  \textbackslash{}
         p214-010-60001-cl.png     \ldots       131044  0.541212  0.118465  0.141845
         p214-010-60001-cr.png     \ldots       131044  0.541212  0.118465  0.141845
         p214-010-60001-ml.png     \ldots       131044  0.541212  0.118465  0.141845
         p214-010-60001-mr.png     \ldots       131044  0.541212  0.118465  0.141845
         p214-010-60005-cl.png     \ldots       131044  0.683325  0.142954  0.079646

                                   25\%\_9    50\%\_9     75\%\_9     max\_9    skew\_9  \textbackslash{}
         p214-010-60001-cl.png  0.462988  0.54614  0.624509  0.921247 -0.150691
         p214-010-60001-cr.png  0.462988  0.54614  0.624509  0.921247 -0.150691
         p214-010-60001-ml.png  0.462988  0.54614  0.624509  0.921247 -0.150691
         p214-010-60001-mr.png  0.462988  0.54614  0.624509  0.921247 -0.150691
         p214-010-60005-cl.png  0.597345  0.70354  0.792035  0.995575 -0.848023

                                kurtosis\_9
         p214-010-60001-cl.png    0.148522
         p214-010-60001-cr.png    0.148522
         p214-010-60001-ml.png    0.148522
         p214-010-60001-mr.png    0.148522
         p214-010-60005-cl.png    0.758542

         [5 rows x 100 columns]
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                          \PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                          \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

          \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
          \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/intensity\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{longtable}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
          \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}106}]:}                   KS       p-value
          count       0.000000  1.000000e+00
          mean        1.000000  3.587622e-59
          std         0.876389  1.515491e-45
          min         1.000000  3.587622e-59
          25\%         1.000000  3.587622e-59
          50\%         1.000000  3.587622e-59
          75\%         1.000000  3.587622e-59
          max         1.000000  3.587622e-59
          skew        0.891667  3.923764e-47
          kurtosis    0.568056  2.209941e-19
          count\_1     0.000000  1.000000e+00
          mean\_1      1.000000  3.587622e-59
          std\_1       0.981944  4.539903e-57
          min\_1       1.000000  3.587622e-59
          25\%\_1       1.000000  3.587622e-59
          50\%\_1       1.000000  3.587622e-59
          75\%\_1       1.000000  3.587622e-59
          max\_1       0.997222  7.598385e-59
          skew\_1      0.784722  1.335838e-36
          kurtosis\_1  0.466667  3.216681e-13
          count\_2     0.000000  1.000000e+00
          mean\_2      1.000000  3.587622e-59
          std\_2       1.000000  3.587622e-59
          min\_2       1.000000  3.587622e-59
          25\%\_2       1.000000  3.587622e-59
          50\%\_2       1.000000  3.587622e-59
          75\%\_2       1.000000  3.587622e-59
          max\_2       0.994444  1.605940e-58
          skew\_2      0.501389  3.410114e-15
          kurtosis\_2  0.436111  1.342503e-11
          \ldots              \ldots           \ldots
          count\_7     0.000000  1.000000e+00
          mean\_7      1.000000  3.587622e-59
          std\_7       0.955556  4.577742e-54
          min\_7       1.000000  3.587622e-59
          25\%\_7       1.000000  3.587622e-59
          50\%\_7       1.000000  3.587622e-59
          75\%\_7       1.000000  3.587622e-59
          max\_7       0.740278  1.280685e-32
          skew\_7      0.319444  2.024353e-06
          kurtosis\_7  0.304167  7.344875e-06
          count\_8     0.000000  1.000000e+00
          mean\_8      1.000000  3.587622e-59
          std\_8       0.929167  3.823290e-51
          min\_8       1.000000  3.587622e-59
          25\%\_8       1.000000  3.587622e-59
          50\%\_8       1.000000  3.587622e-59
          75\%\_8       1.000000  3.587622e-59
          max\_8       0.736111  2.943248e-32
          skew\_8      0.547222  5.120902e-18
          kurtosis\_8  0.395833  1.248634e-09
          count\_9     0.000000  1.000000e+00
          mean\_9      1.000000  3.587622e-59
          std\_9       0.956944  3.195999e-54
          min\_9       1.000000  3.587622e-59
          25\%\_9       1.000000  3.587622e-59
          50\%\_9       1.000000  3.587622e-59
          75\%\_9       0.997222  7.598385e-59
          max\_9       0.794444  1.674259e-37
          skew\_9      0.702778  1.934059e-29
          kurtosis\_9  0.891667  3.923764e-47

          [100 rows x 2 columns]
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 2.401870
[t-SNE] Error after 83 iterations with early exaggeration: 14.124506
[t-SNE] Error after 276 iterations: 0.673903
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/intensity\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 2.401870
[t-SNE] Error after 100 iterations with early exaggeration: 17.879216
[t-SNE] Error after 346 iterations: 1.711401
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}99}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x10f3a8690>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/intensity\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}101}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x10e572ed0>
\end{Verbatim}

    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/intensity\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}102}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x107926a50>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{50}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

         \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/intensity\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis_files/intensity-analysis_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

\section*{Blob Texture Analysis}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{qt}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Warning: Cannot change to a different GUI toolkit: qt. Using osx instead.
    \end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{real\PYZus{}texture.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{hologic}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}

        \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{synthetic\PYZus{}texture.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{phantom}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                               \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
        \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
        \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
        \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{hologic\PYZus{}texture\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{hologic}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{phantom}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{,}
                                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
        \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
        \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}                          contrast  dissimilarity  homogeneity    energy  \textbackslash{}
        p214-010-60001-cl.png  180.015284      10.623496     0.092774  0.068239
        p214-010-60001-cr.png  241.273806      10.449699     0.101719  0.073124
        p214-010-60001-ml.png  217.490041      11.182093     0.089156  0.068559
        p214-010-60001-mr.png  288.353799      11.644971     0.093407  0.073823
        p214-010-60005-cl.png  160.227140      10.034384     0.099470  0.069002

                               contrast\_1  dissimilarity\_1  homogeneity\_1  energy\_1  \textbackslash{}
        p214-010-60001-cl.png  281.402566        10.773226       0.103179  0.056349
        p214-010-60001-cr.png  257.052029        10.725951       0.098164  0.051589
        p214-010-60001-ml.png  255.275936        11.383161       0.091460  0.052581
        p214-010-60001-mr.png  237.048490        11.298087       0.089295  0.050686
        p214-010-60005-cl.png  157.603883         9.991076       0.096144  0.051515

                               contrast\_2  dissimilarity\_2    \ldots     homogeneity\_7  \textbackslash{}
        p214-010-60001-cl.png  166.662740        10.250118    \ldots          0.099589
        p214-010-60001-cr.png  236.447806        10.048496    \ldots          0.104395
        p214-010-60001-ml.png  223.895510        10.859934    \ldots          0.094498
        p214-010-60001-mr.png  173.248493        10.351740    \ldots          0.099926
        p214-010-60005-cl.png  148.042716         9.647045    \ldots          0.106255

                               energy\_7  contrast\_8  dissimilarity\_8  homogeneity\_8  \textbackslash{}
        p214-010-60001-cl.png  0.016556  163.937053        10.084599       0.099519
        p214-010-60001-cr.png  0.015297  166.288393         9.918993       0.107002
        p214-010-60001-ml.png  0.014957  171.293827        10.346745       0.094648
        p214-010-60001-mr.png  0.015496  166.981656        10.147627       0.096699
        p214-010-60005-cl.png  0.017021  166.288393         9.918993       0.107002

                               energy\_8  contrast\_9  dissimilarity\_9  homogeneity\_9  \textbackslash{}
        p214-010-60001-cl.png  0.013505  157.454233         9.781551       0.105151
        p214-010-60001-cr.png  0.022819  157.454233         9.781551       0.105151
        p214-010-60001-ml.png  0.014245  157.454233         9.781551       0.105151
        p214-010-60001-mr.png  0.013841  157.454233         9.781551       0.105151
        p214-010-60005-cl.png  0.022819  127.449202         8.913421       0.110486

                               energy\_9
        p214-010-60001-cl.png  0.019975
        p214-010-60001-cr.png  0.019975
        p214-010-60001-ml.png  0.019975
        p214-010-60001-mr.png  0.019975
        p214-010-60005-cl.png  0.016995

        [5 rows x 40 columns]
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                         \PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

         \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                \PY{n}{index}\PY{o}{=}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/texture\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:}                        KS       p-value
         contrast         0.381944  5.383186e-09
         dissimilarity    1.000000  3.587622e-59
         homogeneity      1.000000  3.587622e-59
         energy           1.000000  3.587622e-59
         contrast\_1       0.586111  1.318746e-20
         dissimilarity\_1  1.000000  3.587622e-59
         homogeneity\_1    1.000000  3.587622e-59
         energy\_1         1.000000  3.587622e-59
         contrast\_2       0.863889  2.874007e-44
         dissimilarity\_2  1.000000  3.587622e-59
         homogeneity\_2    1.000000  3.587622e-59
         energy\_2         1.000000  3.587622e-59
         contrast\_3       0.923611  1.538596e-50
         dissimilarity\_3  1.000000  3.587622e-59
         homogeneity\_3    1.000000  3.587622e-59
         energy\_3         1.000000  3.587622e-59
         contrast\_4       0.845833  1.870608e-42
         dissimilarity\_4  1.000000  3.587622e-59
         homogeneity\_4    1.000000  3.587622e-59
         energy\_4         1.000000  3.587622e-59
         contrast\_5       0.979167  9.485680e-57
         dissimilarity\_5  1.000000  3.587622e-59
         homogeneity\_5    1.000000  3.587622e-59
         energy\_5         1.000000  3.587622e-59
         contrast\_6       1.000000  3.587622e-59
         dissimilarity\_6  1.000000  3.587622e-59
         homogeneity\_6    1.000000  3.587622e-59
         energy\_6         0.994444  1.605940e-58
         contrast\_7       0.969444  1.230285e-55
         dissimilarity\_7  1.000000  3.587622e-59
         homogeneity\_7    1.000000  3.587622e-59
         energy\_7         1.000000  3.587622e-59
         contrast\_8       0.986111  1.497318e-57
         dissimilarity\_8  1.000000  3.587622e-59
         homogeneity\_8    1.000000  3.587622e-59
         energy\_8         0.997222  7.598385e-59
         contrast\_9       1.000000  3.587622e-59
         dissimilarity\_9  1.000000  3.587622e-59
         homogeneity\_9    1.000000  3.587622e-59
         energy\_9         1.000000  3.587622e-59
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.834920
[t-SNE] Error after 83 iterations with early exaggeration: 12.847253
[t-SNE] Error after 296 iterations: 0.467811
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.834920
[t-SNE] Error after 100 iterations with early exaggeration: 14.777595
[t-SNE] Error after 271 iterations: 0.948866
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x110926f90>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}81}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x118f53690>
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}


    \begin{verbatim}
<matplotlib.figure.Figure at 0x118f3ec10>
    \end{verbatim}


    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x1105098d0>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{10}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

         \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
\section*{Line Analysis}



    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{inline}
          \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Warning: Cannot change to a different GUI toolkit: qt. Using osx instead.
    \end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{real\PYZhy{}lines.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
          \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{phantom\PYZhy{}lines.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
          \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                                 \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
          \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
          \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

          \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
          \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
          \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{n}{hologic\PYZus{}line\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{features\PYZus{}from\PYZus{}lines}\PY{p}{(}\PY{n}{hologic}\PY{p}{)}
          \PY{n}{phantom\PYZus{}line\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{features\PYZus{}from\PYZus{}lines}\PY{p}{(}\PY{n}{phantom}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
          \PY{n}{phantom\PYZus{}line\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
          \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}line\PYZus{}features}\PY{p}{,}
                                                                           \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
          \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
          \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}118}]:}                        count        mean         std  min    25\%   50\%  \textbackslash{}
          p214-010-60001-cl.png     72  161.791667  245.194659    1  61.50  94.5
          p214-010-60001-cr.png     57  176.421053  460.921203    1  59.00  77.0
          p214-010-60001-ml.png     72  200.708333  296.524822    1  62.00  95.5
          p214-010-60001-mr.png     74  203.459459  371.688380    1  52.25  81.0
          p214-010-60005-cl.png    114  143.184211  152.914376    1  58.25  89.5

                                    75\%   max      skew   kurtosis  upper\_dist\_count
          p214-010-60001-cl.png  137.25  1744  4.786025  26.793023                16
          p214-010-60001-cr.png  152.00  3494  6.905092  50.202367                13
          p214-010-60001-ml.png  210.50  1662  3.484285  13.937538                19
          p214-010-60001-mr.png  192.25  2522  4.309621  22.429202                16
          p214-010-60005-cl.png  170.75   911  2.667624   9.028130                36
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{min}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                          \PY{n}{phantom\PYZus{}line\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                          \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

          \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
          \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/line\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{)}
          \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}120}]:}                         KS       p-value
          count             0.933333  1.338265e-51
          mean              0.593056  4.356206e-21
          std               0.654167  1.450514e-25
          25\%               0.143056  1.255126e-01
          50\%               0.304167  7.344875e-06
          75\%               0.508333  1.320817e-15
          max               0.737500  2.231475e-32
          skew              0.480556  5.426886e-14
          kurtosis          0.506944  1.598384e-15
          upper\_dist\_count  0.913889  1.724254e-49
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
          \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.935505
[t-SNE] Error after 83 iterations with early exaggeration: 14.319531
[t-SNE] Error after 292 iterations: 0.654946
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.935505
[t-SNE] Error after 92 iterations with early exaggeration: 14.468912
[t-SNE] Error after 333 iterations: 0.664658
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}160}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{c}{\PYZsh{} plt.savefig(\PYZsq{}figures/mappings/line\PYZus{}SNE\PYZus{}mapping\PYZus{}3d.png\PYZsq{}, dpi=300)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}160}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x110d3dd50>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
          \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}163}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{c}{\PYZsh{} plt.savefig(\PYZsq{}figures/mappings/line\PYZus{}iso\PYZus{}mapping\PYZus{}3d.png\PYZsq{}, dpi=300)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}163}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x113f47b90>
\end{Verbatim}

    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
              \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
          \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}162}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}line\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                       \PY{n}{phantom\PYZus{}line\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
          \PY{c}{\PYZsh{} plt.savefig(\PYZsq{}figures/mappings/line\PYZus{}lle\PYZus{}mapping\PYZus{}3d.png\PYZsq{}, dpi=300)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}162}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x113799550>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{50}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}137}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
          \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
          \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

          \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
          \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
          \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                             \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}138}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}139}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                             \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                             \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                             \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                        \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                        \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                  \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                  \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                    \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                             \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                             \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                             \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                               \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}147}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                        \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                        \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                        \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
          \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}149}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                  \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                  \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
          \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{line-analysis_files/line-analysis_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    
\subsection*{Line Intensity Analysis}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{inline}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{real\PYZus{}intensity\PYZus{}lines.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{hologic}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}

        \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{synthetic\PYZus{}intensity\PYZus{}lines.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{phantom}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                               \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
        \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
        \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
        \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{hologic\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{hologic}\PY{p}{[}\PY{n}{hologic}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{:}\PY{p}{]}\PY{p}{]}
         \PY{n}{hologic\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{hologic}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}
         \PY{n}{phantom\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{phantom}\PY{p}{[}\PY{n}{phantom}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{:}\PY{p}{]}\PY{p}{]}
         \PY{n}{phantom\PYZus{}intensity\PYZus{}features} \PY{o}{=} \PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{phantom}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{o}{.}\PY{n}{agg}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
        \PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset} \PYZbs{}
            \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
        \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
        \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:}                            mean       std       min       25\%       50\%  \textbackslash{}
        p214-010-60001-cl.png  0.362584  0.099563  0.176311  0.290825  0.350695
        p214-010-60001-cr.png  0.326219  0.102222  0.153672  0.250758  0.317584
        p214-010-60001-ml.png  0.394061  0.102072  0.194879  0.324951  0.387695
        p214-010-60001-mr.png  0.346520  0.092847  0.181811  0.286208  0.339103
        p214-010-60005-cl.png  0.406239  0.110257  0.187572  0.328258  0.400346

                                    75\%       max      skew  kurtosis
        p214-010-60001-cl.png  0.425325  0.651941  0.554375  0.564813
        p214-010-60001-cr.png  0.391641  0.590179  0.510056  0.047178
        p214-010-60001-ml.png  0.456746  0.673763  0.354676  0.266671
        p214-010-60001-mr.png  0.398680  0.605823  0.455182  0.255500
        p214-010-60005-cl.png  0.478228  0.672765  0.219887 -0.055904
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                         \PY{n}{phantom\PYZus{}intensity\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

         \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{selected\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/line\PYZus{}intensity\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:}                 KS       p-value
         mean      1.000000  3.587622e-59
         std       0.966667  2.546525e-55
         min       1.000000  3.587622e-59
         25\%       1.000000  3.587622e-59
         50\%       1.000000  3.587622e-59
         75\%       1.000000  3.587622e-59
         max       1.000000  3.587622e-59
         skew      1.000000  3.587622e-59
         kurtosis  0.213889  4.106586e-03
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.599228
[t-SNE] Error after 83 iterations with early exaggeration: 13.517177
[t-SNE] Error after 280 iterations: 0.549352
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}intensity\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.599228
[t-SNE] Error after 83 iterations with early exaggeration: 13.324412
[t-SNE] Error after 173 iterations: 0.359292
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x101fef190>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}intensity\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
         \PY{n}{features}\PY{p}{[}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{features}\PY{p}{[}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:}            mean       std       min       25\%       50\%       75\%       max  \textbackslash{}
         count -2.000000 -2.000000 -2.000000 -2.000000 -2.000000 -2.000000 -2.000000
         mean  -0.003513 -0.021104  0.036702  0.011160 -0.003569 -0.018553 -0.039642
         std    0.061442  0.001805  0.071537  0.066832  0.061887  0.056479  0.040878
         min   -0.006950 -0.069210  0.024354  0.007557 -0.005128 -0.026422 -0.070078
         25\%   -0.021067 -0.018684  0.012954 -0.012430 -0.020751 -0.031740 -0.059877
         50\%   -0.025319 -0.018390  0.019640 -0.008693 -0.024878 -0.037709 -0.054216
         75\%   -0.014675 -0.021351  0.020545 -0.000035 -0.016425 -0.033499 -0.039873
         max    0.459748 -0.029071  0.634287  0.525722  0.458126  0.396945  0.236608

                    skew  kurtosis
         count -2.000000 -2.000000
         mean   0.120643  0.351995
         std    0.069032  0.354517
         min   -0.634472  0.076846
         25\%    0.173825  0.253910
         50\%    0.155946  0.251659
         75\%    0.116317  0.313281
         max    0.183788  3.838945
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_30_1.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x10204ae10>
\end{Verbatim}

    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/line\PYZus{}intensity\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}intensity\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}intensity\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x108282a50>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{50}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

         \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/line\PYZus{}intensity\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{intensity-analysis-lines_files/intensity-analysis-lines_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}


\section*{Line Texture Analysis}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} \PY{n}{qt}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k+kn}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{scipy.stats} \PY{k+kn}{as} \PY{n+nn}{stats}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{mia}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Warning: Cannot change to a different GUI toolkit: qt. Using osx instead.
    \end{Verbatim}

    \section{Loading and Preprocessing}\label{loading-and-preprocessing}

    Loading the hologic and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{hologic} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{real\PYZus{}texture.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{hologic}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{hologic}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}

        \PY{n}{phantom} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{o}{.}\PY{n}{from\PYZus{}csv}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{synthetic\PYZus{}texture.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{phantom}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n}{phantom}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{breast\PYZus{}area}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    Loading the meta data for the real and synthetic datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{hologic\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}hologic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{hologic}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/real\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}synthetic\PYZus{}meta\PYZus{}data}\PY{p}{(}\PY{n}{phantom}\PY{p}{,}
                                                               \PY{l+s}{\PYZdq{}}\PY{l+s}{meta\PYZus{}data/synthetic\PYZus{}meta.csv}\PY{l+s}{\PYZdq{}}\PY{p}{)}
        \PY{n}{phantom\PYZus{}meta}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZsq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZsq{}}
\end{Verbatim}

    Prepare the BI-RADS/VBD labels for both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{hologic\PYZus{}labels} \PY{o}{=} \PY{n}{hologic\PYZus{}meta}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{BIRADS}
        \PY{n}{phantom\PYZus{}labels} \PY{o}{=} \PY{n}{phantom\PYZus{}meta}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{VBD.1}\PY{l+s}{\PYZsq{}}\PY{p}{]}

        \PY{n}{class\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}labels}\PY{p}{,} \PY{n}{phantom\PYZus{}labels}\PY{p}{]}\PY{p}{)}
        \PY{n}{class\PYZus{}labels}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{img\PYZus{}name}\PY{l+s}{\PYZdq{}}
        \PY{n}{labels} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{class\PYZus{}labels}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}

    \section{Creating Features}\label{creating-features}

    Create blob features from distribution of blobs

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{hologic\PYZus{}texture\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{hologic}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{group\PYZus{}by\PYZus{}scale\PYZus{}space}\PY{p}{(}\PY{n}{phantom}\PY{p}{)}
\end{Verbatim}

    Take a random subset of the phantom mammograms. This is important so
that each case is not over represented.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{syn\PYZus{}feature\PYZus{}meta} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{remove\PYZus{}duplicate\PYZus{}index}\PY{p}{(}\PY{n}{phantom\PYZus{}meta}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{syn\PYZus{}feature\PYZus{}meta}\PY{o}{.}\PY{n}{phantom\PYZus{}name}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{create\PYZus{}random\PYZus{}subset}\PY{p}{(}\PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{,}
                                                                            \PY{l+s}{\PYZsq{}}\PY{l+s}{phantom\PYZus{}name}\PY{l+s}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    Combine the features from both datasets.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{features} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{p}{,} \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{p}{]}\PY{p}{)}
        \PY{k}{assert} \PY{n}{features}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{366}
        \PY{n}{features}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}                          contrast  dissimilarity  homogeneity    energy  \textbackslash{}
        p214-010-60001-cl.png  180.015284      10.623496     0.092774  0.068239
        p214-010-60001-cr.png  241.273806      10.449699     0.101719  0.073124
        p214-010-60001-ml.png  217.490041      11.182093     0.089156  0.068559
        p214-010-60001-mr.png  288.353799      11.644971     0.093407  0.073823
        p214-010-60005-cl.png  160.227140      10.034384     0.099470  0.069002

                               contrast\_1  dissimilarity\_1  homogeneity\_1  energy\_1  \textbackslash{}
        p214-010-60001-cl.png  281.402566        10.773226       0.103179  0.056349
        p214-010-60001-cr.png  257.052029        10.725951       0.098164  0.051589
        p214-010-60001-ml.png  255.275936        11.383161       0.091460  0.052581
        p214-010-60001-mr.png  237.048490        11.298087       0.089295  0.050686
        p214-010-60005-cl.png  157.603883         9.991076       0.096144  0.051515

                               contrast\_2  dissimilarity\_2    \ldots     homogeneity\_7  \textbackslash{}
        p214-010-60001-cl.png  166.662740        10.250118    \ldots          0.099589
        p214-010-60001-cr.png  236.447806        10.048496    \ldots          0.104395
        p214-010-60001-ml.png  223.895510        10.859934    \ldots          0.094498
        p214-010-60001-mr.png  173.248493        10.351740    \ldots          0.099926
        p214-010-60005-cl.png  148.042716         9.647045    \ldots          0.106255

                               energy\_7  contrast\_8  dissimilarity\_8  homogeneity\_8  \textbackslash{}
        p214-010-60001-cl.png  0.016556  163.937053        10.084599       0.099519
        p214-010-60001-cr.png  0.015297  166.288393         9.918993       0.107002
        p214-010-60001-ml.png  0.014957  171.293827        10.346745       0.094648
        p214-010-60001-mr.png  0.015496  166.981656        10.147627       0.096699
        p214-010-60005-cl.png  0.017021  166.288393         9.918993       0.107002

                               energy\_8  contrast\_9  dissimilarity\_9  homogeneity\_9  \textbackslash{}
        p214-010-60001-cl.png  0.013505  157.454233         9.781551       0.105151
        p214-010-60001-cr.png  0.022819  157.454233         9.781551       0.105151
        p214-010-60001-ml.png  0.014245  157.454233         9.781551       0.105151
        p214-010-60001-mr.png  0.013841  157.454233         9.781551       0.105151
        p214-010-60005-cl.png  0.022819  127.449202         8.913421       0.110486

                               energy\_9
        p214-010-60001-cl.png  0.019975
        p214-010-60001-cr.png  0.019975
        p214-010-60001-ml.png  0.019975
        p214-010-60001-mr.png  0.019975
        p214-010-60005-cl.png  0.016995

        [5 rows x 40 columns]
\end{Verbatim}

    Filter some features, such as the min, to remove noise.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{selected\PYZus{}features} \PY{o}{=} \PY{n}{features}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \section{Compare Real and Synthetic
Features}\label{compare-real-and-synthetic-features}

    Compare the distributions of features detected from the real mammograms
and the phantoms using the Kolmogorov-Smirnov two sample test.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{ks\PYZus{}stats} \PY{o}{=} \PY{p}{[}\PY{n+nb}{list}\PY{p}{(}\PY{n}{stats}\PY{o}{.}\PY{n}{ks\PYZus{}2samp}\PY{p}{(}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{,}
                                         \PY{n}{phantom\PYZus{}texture\PYZus{}features}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                                         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{]}

         \PY{n}{ks\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{ks\PYZus{}stats}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{KS}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{p\PYZhy{}value}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                                \PY{n}{index}\PY{o}{=}\PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}\PY{o}{.}\PY{n}{to\PYZus{}latex}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{tables/texture\PYZus{}features\PYZus{}ks.tex}\PY{l+s}{\PYZdq{}}\PY{p}{)}
         \PY{n}{ks\PYZus{}test}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:}                        KS       p-value
         contrast         0.381944  5.383186e-09
         dissimilarity    1.000000  3.587622e-59
         homogeneity      1.000000  3.587622e-59
         energy           1.000000  3.587622e-59
         contrast\_1       0.586111  1.318746e-20
         dissimilarity\_1  1.000000  3.587622e-59
         homogeneity\_1    1.000000  3.587622e-59
         energy\_1         1.000000  3.587622e-59
         contrast\_2       0.863889  2.874007e-44
         dissimilarity\_2  1.000000  3.587622e-59
         homogeneity\_2    1.000000  3.587622e-59
         energy\_2         1.000000  3.587622e-59
         contrast\_3       0.923611  1.538596e-50
         dissimilarity\_3  1.000000  3.587622e-59
         homogeneity\_3    1.000000  3.587622e-59
         energy\_3         1.000000  3.587622e-59
         contrast\_4       0.845833  1.870608e-42
         dissimilarity\_4  1.000000  3.587622e-59
         homogeneity\_4    1.000000  3.587622e-59
         energy\_4         1.000000  3.587622e-59
         contrast\_5       0.979167  9.485680e-57
         dissimilarity\_5  1.000000  3.587622e-59
         homogeneity\_5    1.000000  3.587622e-59
         energy\_5         1.000000  3.587622e-59
         contrast\_6       1.000000  3.587622e-59
         dissimilarity\_6  1.000000  3.587622e-59
         homogeneity\_6    1.000000  3.587622e-59
         energy\_6         0.994444  1.605940e-58
         contrast\_7       0.969444  1.230285e-55
         dissimilarity\_7  1.000000  3.587622e-59
         homogeneity\_7    1.000000  3.587622e-59
         energy\_7         1.000000  3.587622e-59
         contrast\_8       0.986111  1.497318e-57
         dissimilarity\_8  1.000000  3.587622e-59
         homogeneity\_8    1.000000  3.587622e-59
         energy\_8         0.997222  7.598385e-59
         contrast\_9       1.000000  3.587622e-59
         dissimilarity\_9  1.000000  3.587622e-59
         homogeneity\_9    1.000000  3.587622e-59
         energy\_9         1.000000  3.587622e-59
\end{Verbatim}

    \section{Dimensionality Reduction}\label{dimensionality-reduction}

\subsection{t-SNE}\label{t-sne}

Running t-SNE to obtain a two dimensional representation.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{learning\PYZus{}rate}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{300}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{perplexity}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{30}\PY{p}{,}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{verbose}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.834920
[t-SNE] Error after 83 iterations with early exaggeration: 12.847253
[t-SNE] Error after 296 iterations: 0.467811
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}SNE\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    Running t-SNE to obtain a 3 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{tSNE}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[t-SNE] Computing pairwise distances\ldots
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.834920
[t-SNE] Error after 100 iterations with early exaggeration: 14.777595
[t-SNE] Error after 271 iterations: 0.948866
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x110926f90>
\end{Verbatim}

    \subsection{Isomap}\label{isomap}

Running Isomap to obtain a 2 dimensional mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{iso\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}iso\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_30_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{iso\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{isomap}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{iso\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}81}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x118f53690>
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}


    \begin{verbatim}
<matplotlib.figure.Figure at 0x118f3ec10>
    \end{verbatim}


    \subsection{Locally Linear Embedding}\label{locally-linear-embedding}

Running locally linear embedding to obtain 2d mapping

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{lle\PYZus{}kwargs} \PY{o}{=} \PY{p}{\PYZob{}}
             \PY{l+s}{\PYZsq{}}\PY{l+s}{n\PYZus{}neighbors}\PY{l+s}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{10}\PY{p}{,}
         \PY{p}{\PYZcb{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}2d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}2d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/mappings/texture\PYZus{}lle\PYZus{}mapping\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{lle\PYZus{}mapping\PYZus{}3d} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{analysis}\PY{o}{.}\PY{n}{lle}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{lle\PYZus{}kwargs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{mia}\PY{o}{.}\PY{n}{plotting}\PY{o}{.}\PY{n}{plot\PYZus{}mapping\PYZus{}3d}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{,} \PY{n}{hologic\PYZus{}texture\PYZus{}features}\PY{o}{.}\PY{n}{index}\PY{p}{,}
                                      \PY{n}{phantom\PYZus{}texture\PYZus{}features\PYZus{}subset}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:} <matplotlib.axes.\_subplots.Axes3DSubplot at 0x1105098d0>
\end{Verbatim}

    \subsection{Quality Assessment of Dimensionality
Reduction}\label{quality-assessment-of-dimensionality-reduction}

    Assess the quality of the DR against measurements from the co-ranking
matrices. First create co-ranking matrices for each of the
dimensionality reduction mappings

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{max\PYZus{}k} \PY{o}{=} \PY{l+m+mi}{10}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}2d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}2d}\PY{p}{)}

         \PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{SNE\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{iso\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
         \PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm} \PY{o}{=} \PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{coranking\PYZus{}matrix}\PY{p}{(}\PY{n}{selected\PYZus{}features}\PY{p}{,}
                                                            \PY{n}{lle\PYZus{}mapping\PYZus{}3d}\PY{p}{)}
\end{Verbatim}

    \subsubsection{2D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{trustworthiness\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}trustworthiness\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{continuity\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}2d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}continuity\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}2d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}2d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{lcmc\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}2d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}2d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}lcmc\PYZus{}2d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \subsubsection{3D Mappings}\label{d-mappings}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{trustworthiness}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                                   \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{trustworthiness3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{iso\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{,}
                                            \PY{n}{lle\PYZus{}trustworthiness\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                            \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{trustworthiness3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}trustworthiness\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{SNE\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}continuity\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{continuity}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                              \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{continuity3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{iso\PYZus{}continuity\PYZus{}3d}\PY{p}{,}
                                       \PY{n}{lle\PYZus{}continuity\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                       \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{continuity3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}continuity\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{SNE\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{SNE\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{iso\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{iso\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
         \PY{n}{lle\PYZus{}lcmc\PYZus{}3d} \PY{o}{=} \PY{p}{[}\PY{n}{mia}\PY{o}{.}\PY{n}{coranking}\PY{o}{.}\PY{n}{LCMC}\PY{p}{(}\PY{n}{lle\PYZus{}mapping\PYZus{}3d\PYZus{}cm}\PY{p}{,} \PY{n}{k}\PY{p}{)}
                        \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{max\PYZus{}k}\PY{p}{)}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{lcmc3d\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{n}{SNE\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{iso\PYZus{}lcmc\PYZus{}3d}\PY{p}{,}
                                 \PY{n}{lle\PYZus{}lcmc\PYZus{}3d}\PY{p}{]}\PY{p}{,}
                                 \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZsq{}}\PY{l+s}{SNE}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{Isomap}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{l+s}{\PYZsq{}}\PY{l+s}{LLE}\PY{l+s}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{lcmc3d\PYZus{}df}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{figures/quality\PYZus{}measures/texture\PYZus{}lcmc\PYZus{}3d.png}\PY{l+s}{\PYZsq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{300}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{texture-analysis_files/texture-analysis_56_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
